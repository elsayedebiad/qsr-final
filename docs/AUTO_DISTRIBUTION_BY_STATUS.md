# ุงูุชูุฒูุน ุงูุชููุงุฆู ููุณูุฑ ุงูุฐุงุชูุฉ ุญุณุจ ุงูุญุงูุฉ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ุฐูู ูุชูุฒูุน ุงูุณูุฑ ุงูุฐุงุชูุฉ ุชููุงุฆููุง ุฅูู ุงูุตูุญุงุช ุงูููุงุณุจุฉ ุจูุงุกู ุนูู ุญุงูุชูุง ุนูุฏ ุงูุฑูุน ุงูุฐูู ุฃู ุงูุชุญุฏูุซ.

## ููู ูุนูู ุงููุธุงูุ

### 1. ุนูุฏ ุฑูุน ุณูุฑุฉ ุฐุงุชูุฉ ุฌุฏูุฏุฉ

```
ููู Excel โ ูุฑุงุกุฉ ุนููุฏ ุงูุญุงูุฉ โ ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช โ ุชูุฒูุน ุชููุงุฆู
```

**ูุซุงู:**
```
ุงูุงุณู: ูุงุทูุฉ ุฃุญูุฏ
ุงูุญุงูุฉ: ูุชุนุงูุฏ
ุงููุชูุฌุฉ: 
  โ ุชูุญูุธ ุจุญุงูุฉ HIRED
  โ ุชูุฒุงู ูู ุฌููุน ุตูุญุงุช ุงููุจูุนุงุช
  โ ุชุธูุฑ ูู ุตูุญุฉ ุงูุชุนุงูุฏุงุช
  โ ููุณุฌู ุงููุดุงุท ูู ุณุฌู ุงูุชูุฒูุน
```

### 2. ุนูุฏ ุชุญุฏูุซ ุณูุฑุฉ ุฐุงุชูุฉ ููุฌูุฏุฉ

```
ููู Excel โ ูุฑุงุกุฉ ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ โ ููุงุฑูุฉ ูุน ุงููุฏููุฉ โ ุฅุนุงุฏุฉ ุงูุชูุฒูุน ุฅุฐุง ุชุบูุฑุช
```

**ูุซุงู:**
```
ุงูุงุณู: ูุงุฑูุง ุณุงูุชูุณ
ุงูุญุงูุฉ ุงููุฏููุฉ: ุฌุฏูุฏ (NEW)
ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ: ูุญุฌูุฒ (BOOKED)
ุงููุชูุฌุฉ:
  โ ุชูุญุฏุซ ุงูุญุงูุฉ ุฅูู BOOKED
  โ ุชูุฒุงู ูู ุตูุญุงุช ุงููุจูุนุงุช
  โ ุชูุชูู ุฅูู ุตูุญุฉ ุงูุญุฌูุฒุงุช
  โ ููุณุฌู ุงูุชุบููุฑ ูู ุณุฌู ุงูุฃูุดุทุฉ
```

## ุฎุฑูุทุฉ ุงูุชูุฒูุน

| ุงูุญุงูุฉ | ุงูุตูุญุฉ ุงููุณุชูุฏูุฉ | ุงูุฅุฌุฑุงุก |
|--------|------------------|---------|
| **ุฌุฏูุฏ (NEW)** | ุตูุญุงุช ุงููุจูุนุงุช | ุชุจูู ููุชูุฒูุน ุงูุชููุงุฆู |
| **ูุญุฌูุฒ (BOOKED)** | ุตูุญุฉ ุงูุญุฌูุฒุงุช | ุชูุฒุงู ูู ุงููุจูุนุงุช |
| **ูุชุนุงูุฏ (HIRED)** | ุตูุญุฉ ุงูุชุนุงูุฏุงุช | ุชูุฒุงู ูู ุงููุจูุนุงุช |
| **ูุฑููุถ (REJECTED)** | ุตูุญุฉ ุงููุฑููุถุงุช | ุชูุฒุงู ูู ุงููุจูุนุงุช |
| **ูุฑุชุฌุน (RETURNED)** | ุตูุญุฉ ุงููุฑุชุฌุนุงุช | ุชูุฒุงู ูู ุงููุจูุนุงุช |
| **ุฃุฑุดูู (ARCHIVED)** | ุตูุญุฉ ุงูุฃุฑุดูู | ุชูุฒุงู ูู ุงููุจูุนุงุช |

## ุงูุขููุฉ ุงูุชูููุฉ

### ุฏุงูุฉ `distributeCVByStatus`

```typescript
async function distributeCVByStatus(cvId: number, status: string, userId: number) {
  // 1. ุชุญุฏูุฏ ุงูุตูุญุฉ ุงููุณุชูุฏูุฉ ุญุณุจ ุงูุญุงูุฉ
  const targetPage = getTargetPageByStatus(status)
  
  // 2. ุฅุฐุง ูุงูุช ุงูุญุงูุฉ NEWุ ูุง ููุนู ุดูุก (ุชูุฒูุน ุชููุงุฆู)
  if (status === 'NEW') return
  
  // 3. ุฅุฒุงูุฉ ุงูุณูุฑุฉ ูู ุฌููุน ุตูุญุงุช ุงููุจูุนุงุช
  await db.cVDistribution.updateMany({
    where: { cvId, isActive: true },
    data: {
      isActive: false,
      removedAt: new Date(),
      removedBy: userId,
      notes: `ุชู ุงูููู ุชููุงุฆููุง ุจุณุจุจ ุชุบููุฑ ุงูุญุงูุฉ ุฅูู ${status}`
    }
  })
  
  // 4. ุชุณุฌูู ุงููุดุงุท
  await db.distributionLog.create({
    data: {
      action: 'REMOVED_BY_STATUS_CHANGE',
      salesPageId: targetPage,
      cvIds: [cvId],
      userId,
      count: 1,
      details: { status, reason: 'ุชุบููุฑ ุงูุญุงูุฉ ูู ุงูุฑูุน ุงูุฐูู' }
    }
  })
}
```

## ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### ุณููุงุฑูู 1: ุงุณุชูุฑุงุฏ ุฏูุนุฉ ุณูุฑ ุฐุงุชูุฉ ูุชููุนุฉ

**ููู Excel:**
| ุงูุงุณู | ุงูุฌูุณูุฉ | ุงูุญุงูุฉ |
|-------|---------|--------|
| ูุงุทูุฉ | ููุจูููุฉ | ุฌุฏูุฏ |
| ูุงุฑูุง | ุฅูุฏูููุณูุฉ | ูุชุนุงูุฏ |
| ุณุงุฑุฉ | ุจูุบุงููุฉ | ุฃุฑุดูู |
| ููุฑ | ุจุงูุณุชุงููุฉ | ูุญุฌูุฒ |

**ุงููุชูุฌุฉ:**
- โ ูุงุทูุฉ โ ุตูุญุงุช ุงููุจูุนุงุช (ุชูุฒูุน ุชููุงุฆู)
- โ ูุงุฑูุง โ ุตูุญุฉ ุงูุชุนุงูุฏุงุช (ูุจุงุดุฑุฉ)
- โ ุณุงุฑุฉ โ ุตูุญุฉ ุงูุฃุฑุดูู (ูุจุงุดุฑุฉ)
- โ ููุฑ โ ุตูุญุฉ ุงูุญุฌูุฒุงุช (ูุจุงุดุฑุฉ)

### ุณููุงุฑูู 2: ุชุญุฏูุซ ุญุงูุงุช ุงูุณูุฑ

**ูุจู ุงูุชุญุฏูุซ:**
- ุฌููุน ุงูุณูุฑ ุจุญุงูุฉ "ุฌุฏูุฏ" ูู ุตูุญุงุช ุงููุจูุนุงุช

**ููู ุงูุชุญุฏูุซ:**
| ุงูุงุณู | ุงูุญุงูุฉ ุงูุฌุฏูุฏุฉ |
|-------|----------------|
| ูุงุทูุฉ | ูุชุนุงูุฏ |
| ูุงุฑูุง | ูุญุฌูุฒ |

**ุงููุชูุฌุฉ:**
- โ ูุงุทูุฉ: ุชูุฒุงู ูู ุงููุจูุนุงุช โ ุชูุชูู ููุชุนุงูุฏุงุช
- โ ูุงุฑูุง: ุชูุฒุงู ูู ุงููุจูุนุงุช โ ุชูุชูู ููุญุฌูุฒุงุช

## ุงูุชุณุฌูู ูุงููุชุงุจุนุฉ

### ุณุฌู ุงูุชูุฒูุน (DistributionLog)

ูู ุนูููุฉ ููู ุชูุณุฌู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```json
{
  "action": "REMOVED_BY_STATUS_CHANGE",
  "salesPageId": "contracts",
  "cvIds": [123],
  "userId": 1,
  "count": 1,
  "details": {
    "status": "HIRED",
    "reason": "ุชุบููุฑ ุงูุญุงูุฉ ูู ุงูุฑูุน ุงูุฐูู",
    "targetPage": "contracts"
  },
  "timestamp": "2025-11-09T19:30:00Z"
}
```

### ุณุฌู ุงูุฃูุดุทุฉ (ActivityLog)

```json
{
  "action": "CV_UPDATED",
  "description": "ุชู ุชุญุฏูุซ ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ ูู ูุงุทูุฉ ุฃุญูุฏ ุนุจุฑ ุงูุงุณุชูุฑุงุฏ",
  "metadata": {
    "source": "Excel Smart Import",
    "statusChanged": true,
    "oldStatus": "NEW",
    "newStatus": "HIRED"
  }
}
```

## ุงูููุงุฆุฏ

1. **โฑ๏ธ ุชูููุฑ ุงูููุช**: ูุง ุญุงุฌุฉ ูููู ุงูุณูุฑ ูุฏูููุง
2. **๐ฏ ุฏูุฉ ุนุงููุฉ**: ุงูุชูุฒูุน ูุชู ุชููุงุฆููุง ุญุณุจ ุงูุญุงูุฉ ุงููุญุฏุฏุฉ
3. **๐ ุชุชุจุน ูุงูู**: ุฌููุน ุงูุชุบููุฑุงุช ูุณุฌูุฉ ููุคุฑุฎุฉ
4. **๐ ูุฑููุฉ**: ูุนูู ูุน ุงูุฅูุดุงุก ูุงูุชุญุฏูุซ
5. **๐ก๏ธ ุฃูุงู**: ุฌููุน ุงูุนูููุงุช ูุญููุฉ ููุณุฌูุฉ

## ููุงุญุธุงุช ูููุฉ

1. **ุงูุณูุฑ ุงูุฌุฏูุฏุฉ ููุท**: ููุท ุงูุณูุฑ ุจุญุงูุฉ "ุฌุฏูุฏ" ุชุจูู ูู ุตูุญุงุช ุงููุจูุนุงุช
2. **ุงูุฅุฒุงูุฉ ุงูุชููุงุฆูุฉ**: ุงูุณูุฑ ุงูุฃุฎุฑู ุชูุฒุงู ุชููุงุฆููุง ูู ุงููุจูุนุงุช
3. **ุนุฏู ุงูููุฏุงู**: ุงูุณูุฑ ูุง ุชูุญุฐูุ ููุท ุชูุชูู ููุตูุญุฉ ุงูููุงุณุจุฉ
4. **ุงูุชุณุฌูู ุงููุงูู**: ูู ุนูููุฉ ูุณุฌูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

## ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ุณุฌู ุงูุฃูุดุทุฉ
2. ุฑุงุฌุน ุณุฌู ุงูุชูุฒูุน
3. ุชูุงุตู ูุน ูุฑูู ุงูุฏุนู ุงูููู

---

**ุขุฎุฑ ุชุญุฏูุซ**: ููููุจุฑ 2025  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุฅูุชุงุฌ
