# دليل استخدام عمود الحالة في الرفع الذكي

## نظرة عامة
تم إضافة دعم عمود "الحالة" في ميزة الرفع الذكي، مما يسمح بتحديد حالة السيرة الذاتية تلقائيًا من ملف Excel.

## الحالات المدعومة

### 1. جديد (NEW)
- **القيم المقبولة بالعربية**: `جديد`, `جديدة`, `NEW`
- **الوصف**: السيرة الذاتية جديدة ومتاحة للحجز
- **الصفحة**: تظهر في صفحات المبيعات (sales1, sales2, إلخ)

### 2. محجوز (BOOKED)
- **القيم المقبولة بالعربية**: `محجوز`, `محجوزة`, `حجز`, `BOOKED`
- **الوصف**: السيرة الذاتية محجوزة من قبل عميل
- **الصفحة**: تنتقل إلى صفحة الحجوزات

### 3. متعاقد (HIRED)
- **القيم المقبولة بالعربية**: `متعاقد`, `متعاقدة`, `عقد`, `تعاقد`, `HIRED`
- **الوصف**: تم التعاقد على السيرة الذاتية
- **الصفحة**: تنتقل إلى صفحة التعاقدات

### 4. مرفوض (REJECTED)
- **القيم المقبولة بالعربية**: `مرفوض`, `مرفوضة`, `رفض`, `REJECTED`
- **الوصف**: السيرة الذاتية مرفوضة
- **الصفحة**: تنتقل إلى صفحة المرفوضات

### 5. مرتجع (RETURNED)
- **القيم المقبولة بالعربية**: `مرتجع`, `مرتجعة`, `ارتجاع`, `راجع`, `RETURNED`
- **الوصف**: السيرة الذاتية مرتجعة من العميل
- **الصفحة**: تنتقل إلى صفحة المرتجعات

### 6. أرشيف (ARCHIVED)
- **القيم المقبولة بالعربية**: `أرشيف`, `ارشيف`, `مؤرشف`, `مؤرشفة`, `ARCHIVED`
- **الوصف**: السيرة الذاتية في الأرشيف
- **الصفحة**: تنتقل إلى صفحة الأرشيف

## كيفية الاستخدام

### 1. إعداد ملف Excel

أضف عمود باسم "الحالة" في ملف Excel الخاص بك. يمكنك استخدام أي من الأسماء التالية:
- `الحالة`
- `الحاله`
- `حالة السيرة`
- `Status`
- `CV Status`

### 2. مثال على ملف Excel

| الاسم الكامل | الجنسية | العمر | الحالة |
|-------------|---------|------|--------|
| فاطمة أحمد | فلبينية | 28 | جديد |
| ماريا خوسيه | فلبينية | 32 | متعاقد |
| سارة محمد | إندونيسية | 25 | أرشيف |
| نور الهدى | بنغالية | 30 | محجوز |

### 3. رفع الملف

1. انتقل إلى صفحة الرفع الذكي في لوحة التحكم
2. اختر ملف Excel الذي يحتوي على عمود الحالة
3. اضغط على "تحليل الملف" للمعاينة
4. راجع البيانات وتأكد من صحة الحالات
5. اضغط على "تنفيذ الاستيراد"

### 4. النتيجة

- سيتم تحديد حالة كل سيرة ذاتية تلقائيًا بناءً على القيمة في عمود الحالة
- **السير الذاتية ستنتقل تلقائيًا للصفحة المناسبة**:
  - **جديد (NEW)**: تبقى في صفحات المبيعات للتوزيع التلقائي
  - **محجوز (BOOKED)**: تُزال من صفحات المبيعات وتنتقل لصفحة الحجوزات
  - **متعاقد (HIRED)**: تُزال من صفحات المبيعات وتنتقل لصفحة التعاقدات
  - **مرفوض (REJECTED)**: تُزال من صفحات المبيعات وتنتقل لصفحة المرفوضات
  - **مرتجع (RETURNED)**: تُزال من صفحات المبيعات وتنتقل لصفحة المرتجعات
  - **أرشيف (ARCHIVED)**: تُزال من صفحات المبيعات وتنتقل لصفحة الأرشيف
- إذا لم يتم تحديد حالة أو كانت القيمة غير معروفة، ستكون الحالة الافتراضية "جديد" (NEW)

### 5. التحديثات التلقائية

عند تحديث سيرة ذاتية موجودة:
- **يتم التحقق من تغيير الحالة**: النظام يقارن الحالة القديمة بالحالة الجديدة
- **النقل التلقائي**: إذا تغيرت الحالة، يتم نقل السيرة تلقائيًا للصفحة المناسبة
- **تسجيل النشاط**: يتم تسجيل جميع التغييرات في سجل الأنشطة

#### مثال على التحديث:
```
الحالة القديمة: جديد
الحالة الجديدة: متعاقد
النتيجة: تُزال السيرة من صفحات المبيعات وتنتقل لصفحة التعاقدات تلقائيًا
```

## ملاحظات مهمة

1. **حساسية الأحرف**: النظام يتعامل مع الأحرف الكبيرة والصغيرة بنفس الطريقة
2. **القيمة الافتراضية**: إذا كان عمود الحالة فارغًا، ستكون الحالة "جديد" (NEW)
3. **التحديث**: عند تحديث سيرة ذاتية موجودة، سيتم تحديث حالتها أيضًا
4. **التوافق**: يعمل مع جميع صيغ Excel (.xlsx, .xls) وملفات CSV

## أمثلة على الاستخدام

### مثال 1: نقل سير ذاتية للتعاقدات
```
الاسم: أحمد محمد
الحالة: متعاقد
النتيجة: تظهر في صفحة التعاقدات
```

### مثال 2: أرشفة سير ذاتية قديمة
```
الاسم: فاطمة علي
الحالة: أرشيف
النتيجة: تنتقل إلى صفحة الأرشيف
```

### مثال 3: حجز سيرة ذاتية
```
الاسم: ماريا سانتوس
الحالة: محجوز
النتيجة: تظهر في صفحة الحجوزات
```

## الدعم الفني

إذا واجهت أي مشاكل أو كانت لديك أسئلة، يرجى التواصل مع فريق الدعم الفني.

---

**آخر تحديث**: نوفمبر 2025
**الإصدار**: 1.0
