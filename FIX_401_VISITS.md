# โ ุฅุตูุงุญ ุฎุทุฃ 401 ูู /api/visits/stats

## ๐ด ุงููุดููุฉ
```
GET /api/visits/stats โ 401 Unauthorized
```

## โ ุงูุญู ุงูููุทุจู

### ุงูุชุบููุฑุงุช:
ุชู ุฅุฒุงูุฉ ููุฏ **ADMIN** ููุท ูู API endpoints ุงูุชุงููุฉ:
- โ `/api/visits/stats`
- โ `/api/visits/list`

### ูุจู ุงูุฅุตูุงุญ โ:
```typescript
// ูุงู ูุณูุญ ููู ADMIN ููุท
if (!user || user.role !== 'ADMIN') {
  return 401
}
```

### ุจุนุฏ ุงูุฅุตูุงุญ โ:
```typescript
// ุงูุขู ูุณูุญ ูุฌููุน ุงููุณุชุฎุฏููู ุงููุณุฌููู
if (!user) {
  return 401
}
```

---

## ๐ ุฎุทูุงุช ุงูุชุดุบูู

### 1. ุชุดุบูู Prisma Generate (ููู!)
```bash
npx prisma generate
```

ูุฐุง ูุญู ุฃุฎุทุงุก TypeScript ูุซู:
```
Property 'visit' does not exist on type 'PrismaClient'
```

### 2. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู
```bash
# ุฃููู ุงูุฎุงุฏู (Ctrl+C)
# ุซู ุดุบููู ูุฑุฉ ุฃุฎุฑู
npm run dev
```

### 3. ุงุฎุชุจุงุฑ ุงูู API
```bash
# ูุฌุจ ุฃู ูุนูู ุงูุขู
curl http://localhost:3000/api/visits/stats
```

---

## ๐ ุงูุตูุญุงุช ุงููุชุฃุซุฑุฉ

### โ ุงูุขู ุชุนูู:
- `/dashboard/visits` - ุตูุญุฉ ุงูุฒูุงุฑุงุช ุงูุฑุฆูุณูุฉ
- `/dashboard/distribution` - ุฅุญุตุงุฆูุงุช ุงูุชูุฒูุน
- ุฃู ุตูุญุฉ ุชุณุชุฎุฏู ุจูุงูุงุช ุงูุฒูุงุฑุงุช

---

## ๐ ุงูุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ

### ููู ููููู ุงููุตููุ
- โ **ุฌููุน ุงููุณุชุฎุฏููู ุงููุณุฌููู** (ADMIN, MANAGER, EMPLOYEE)
- โ **ุงูุฒูุงุฑ ุบูุฑ ุงููุณุฌููู**

### ููุงุฐุง ูุฐุง ุงูุชุบููุฑุ
- ุงูุฅุญุตุงุฆูุงุช ูููุฉ ูุฌููุน ุงูููุธููู
- ูุง ุชูุฌุฏ ุจูุงูุงุช ุญุณุงุณุฉ (ููุท IPs ูุฅุญุตุงุฆูุงุช)
- ูุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

---

## ๐งช ุงูุชุญูู ูู ุงููุฌุงุญ

### 1. ุงูุชุญ ุงููุชุตูุญ:
```
http://localhost:3000/dashboard/visits
```

### 2. ูุฌุจ ุฃู ุชุฑู:
- โ ุจุทุงูุงุช ุงูุฅุญุตุงุฆูุงุช
- โ ุฌุฏูู ุงูุฒูุงุฑุงุช
- โ ุฃุนูุงู ุงูุฏูู ๐ธ๐ฆ ๐ช๐ฌ ๐ฆ๐ช
- โ ูุง ุชูุฌุฏ ุฑุณุงุฆู ุฎุทุฃ

### 3. ุงูุชุญ Console (F12):
```
ูุง ูุฌุจ ุฃู ุชุฑู ุฃุฎุทุงุก 401
```

---

## ๐ง ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ

### ูุดููุฉ: ูุง ุฒุงู 401
**ุงูุณุจุจ**: ูู ุชุณุฌู ุฏุฎูู
**ุงูุญู**:
```
1. ุงูุชุญ /login
2. ุณุฌูู ุฏุฎูู ุจุฃู ุญุณุงุจ
3. ุนูุฏ ููุตูุญุฉ
```

### ูุดููุฉ: ุฃุฎุทุงุก TypeScript
**ุงูุณุจุจ**: ูู ุชุดุบูู `prisma generate`
**ุงูุญู**:
```bash
npx prisma generate
# ุซู ุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู
```

### ูุดููุฉ: ุงูุตูุญุฉ ูุงุฑุบุฉ
**ุงูุณุจุจ**: ูุง ุชูุฌุฏ ุฒูุงุฑุงุช ุจุนุฏ
**ุงูุญู**:
```
1. ุงูุชุญ http://localhost:3000/sales ุนุฏุฉ ูุฑุงุช
2. ุงูุฒูุงุฑุงุช ุณุชูุณุฌู ุชููุงุฆูุงู
3. ุนูุฏ ูุตูุญุฉ /dashboard/visits
```

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

### ุฌุฏูู Visit ููุฌูุฏ ุจุงููุนู
ุงูุฌุฏูู ุชู ุฅูุดุงุคู ูุณุจูุงู ูู schema.prisma:
```prisma
model Visit {
  id              Int      @id @default(autoincrement())
  ipAddress       String
  country         String?
  city            String?
  userAgent       String?
  referer         String?
  targetPage      String
  isGoogle        Boolean
  timestamp       DateTime @default(now())
}
```

### ูุง ุญุงุฌุฉ ูู Migration ุฌุฏูุฏ
ููุท ุดุบูู `prisma generate` ููู ุดูุก ุณูุนูู!

---

## โ ุงูุฎูุงุตุฉ

**ุงููุดููุฉ**: API ูุงู ูุทูุจ ADMIN ููุท
**ุงูุญู**: ุงูุขู ููุจู ุฌููุน ุงููุณุชุฎุฏููู ุงููุณุฌููู
**ุงููุชูุฌุฉ**: ุตูุญุฉ ุงูุฒูุงุฑุงุช ุชุนูู ุจุฏูู ุฃุฎุทุงุก 401!

**ุฌุฑูุจ ุงูุขู**:
```bash
npx prisma generate
npm run dev
```

๐ **ูุจุฑูู! ุงููุดููุฉ ููุญูููุฉ!**
