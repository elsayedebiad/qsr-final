# โ๏ธ ูููุฏ ุชุญููู ุงููููุงุช ูู Google Drive

## ๐ ุงููุถุน ุงูุญุงูู

### ุงููุดููุฉ ุงูุฃุณุงุณูุฉ:
ุนูุฏ ุชุญููู ุงูุตูุฑ ูู Google Driveุ **ูุง ูููู ุชุบููุฑ ุงุณู ุงูููู** ุจุณุจุจ ูููุฏ CORS ูุณูุงุณุงุช ุงูุฃูุงู ูู ุงููุชุตูุญุงุช.

```
โ ูุง ูุนูู: ุชุญุฏูุฏ ุงุณู ูุฎุตุต ุนุจุฑ download attribute
โ ูุนูู: ูุชุญ ุงูุฑุงุจุท ูู tab ุฌุฏูุฏ (ููู ุจุฏูู ุงุณู ูุฎุตุต)
```

---

## ๐ก ูุง ุชู ุชุทุจููู

### 1. ุฑุณุงูุฉ ุชูุถูุญูุฉ ูููุณุชุฎุฏู
```
๐ ููุงุญุธุฉ: ุณูุชู ูุชุญ ุฑูุงุจุท Google Drive ูู tabs ุฌุฏูุฏุฉ
๐ก ููููู ุชูุฒูู ุงููููุงุช ูุจุงุดุฑุฉ ูู Google Drive
โณ ูุฑุฌู ุงูุงูุชุธุงุฑ ุจูู ูู ุชุญููู...
```

### 2. ุฅูุดุงุก ุฃุณูุงุก ูุฑูุฏุฉ (ููุชูุซูู)
```typescript
const timestamp = Date.now(); // 1731708234567
const randomNum = Math.floor(Math.random() * 10000); // 8934
const fileName = `${cleanName}_${cleanRef}_${timestamp}_${randomNum}.jpg`;
```

**ููู**: Google Drive ูู ูุณุชุฎุฏู ูุฐุง ุงูุงุณู ููุฃุณู.

### 3. ูุชุญ tabs ูุชุนุฏุฏุฉ
ูู ุณูุฑุฉ ุชูุชุญ ูู tab ูููุตูุ ููุง ูุณูุญ ุจุชุญููู ุนุฏุฉ ูููุงุช ุฏูู ุชุฏุงุฎู.

---

## ๐ฏ ุงูุญููู ุงูุจุฏููุฉ

### ุงูุญู 1: ุชุนูููุงุช ูููุณุชุฎุฏู โ (ุงููุทุจู ุญุงููุงู)

**ุงูุฎุทูุงุช:**
1. ุงููุฑ ุนูู "ุชุญููู ุงูุตูุฑ ุงููุญุฏุฏุฉ"
2. ุณุชูุชุญ tabs ุฌุฏูุฏุฉ ููู ุตูุฑุฉ
3. ุญููู ุงูููู ูู Google Drive
4. **ุฃุนุฏ ุชุณููุฉ ุงูููู ูุฏููุงู** ุจุนุฏ ุงูุชุญููู

**ุงููููุฒุงุช:**
- โ ูุนูู ููุฑุงู ุจุฏูู ุชุนููุฏ
- โ ูุง ูุญุชุงุฌ ุชุบููุฑุงุช ูุจูุฑุฉ
- โ ููุซูู 100%

**ุงูุนููุจ:**
- โ ุงููุณุชุฎุฏู ูุญุชุงุฌ ุฅุนุงุฏุฉ ุชุณููุฉ ูุฏููุงู
- โ ููุณ ุชููุงุฆูุงู ุชูุงูุงู

---

### ุงูุญู 2: Server-Side Proxy ๐ง (ูุญุชุงุฌ ุชุทููุฑ)

**ุงูููุฑุฉ:**
ุฅูุดุงุก API route ูู Next.js ูุชูุฑูุฑ ุงูุทูุจ ุนุจุฑ ุงูุฎุงุฏู.

**ุงูุฎุทูุงุช:**
1. ุฅูุดุงุก `/api/download-proxy`
2. ุงูุฎุงุฏู ูุญููู ุงูููู ูู Google Drive
3. ุงูุฎุงุฏู ูุฑุณู ุงูููู ูููุณุชุฎุฏู ุจุงูุงุณู ุงููุฎุตุต

**ุงูููุฏ ุงููุทููุจ:**
```typescript
// src/app/api/download-proxy/route.ts
export async function GET(request: Request) {
  const url = new URL(request.url);
  const fileUrl = url.searchParams.get('url');
  const fileName = url.searchParams.get('filename');
  
  // ุชุญููู ูู Google Drive
  const response = await fetch(fileUrl);
  const blob = await response.blob();
  
  // ุฅุฑุณุงู ูููุณุชุฎุฏู ุจุงูุงุณู ุงููุฎุตุต
  return new Response(blob, {
    headers: {
      'Content-Type': 'image/jpeg',
      'Content-Disposition': `attachment; filename="${fileName}"`
    }
  });
}
```

**ุงููููุฒุงุช:**
- โ ุงุณู ููู ูุฎุตุต ุชููุงุฆูุงู
- โ ุชุญูู ูุงูู ูู ุงูุชุญููู
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ

**ุงูุนููุจ:**
- โ ูุญุชุงุฌ ุชุทููุฑ ุฅุถุงูู
- โ ุงุณุชููุงู bandwidth ุนูู ุงูุฎุงุฏู
- โ ูุฏ ูููู ุจุทูุฆุงู ูููููุงุช ุงููุจูุฑุฉ
- โ ุชูููุฉ ุฅุถุงููุฉ ุนูู Vercel

---

### ุงูุญู 3: Chrome Extension ๐ (ุฎุงุฑุฌ ุงูุชุทุจูู)

**ุงูููุฑุฉ:**
ุฅูุดุงุก Chrome Extension ุชุฑุงูุจ ุงูุชุญูููุงุช ูุชุนูุฏ ุชุณููุชูุง ุชููุงุฆูุงู.

**ุงููููุฒุงุช:**
- โ ุชููุงุฆู ุจุงููุงูู
- โ ูุนูู ูุน ุฃู ูููุน
- โ ูุง ุชุนุฏูู ุนูู ุงูุชุทุจูู

**ุงูุนููุจ:**
- โ ูุญุชุงุฌ ุชุซุจูุช extension
- โ ูุนูู ููุท ุนูู Chrome/Edge
- โ ูุนูุฏ ูููุณุชุฎุฏู ุงูุนุงุฏู

---

### ุงูุญู 4: ุงุณุชุฎุฏุงู Google Drive API ๐ (ุงูุฃูุถู ุชูููุงู)

**ุงูููุฑุฉ:**
ุงูุงุชุตุงู ุจู Google Drive API ุจุดูู ุตุญูุญ ูุน OAuth.

**ุงููููุฒุงุช:**
- โ ูุตูู ูุงูู ูููููุงุช
- โ ุฃุณูุงุก ูุฎุตุตุฉ
- โ ูุนูููุงุช ุฅุถุงููุฉ (ุญุฌูุ ุชุงุฑูุฎุ ุฅูุฎ)

**ุงูุนููุจ:**
- โ ูุญุชุงุฌ Google Cloud Project
- โ ูุญุชุงุฌ OAuth setup ูุนูุฏ
- โ ูุญุชุงุฌ permissions ูู ุงููุณุชุฎุฏููู
- โ ูุฏ ูููู ููููุงู

---

## ๐ ุงูููุงุฑูุฉ

| ุงูุญู | ุงูุณูููุฉ | ุงูุชูููุฉ | ุงูุชููุงุฆูุฉ | ุงูููุซูููุฉ |
|------|---------|---------|-----------|-----------|
| ุชุนูููุงุช ูุฏููุฉ | โญโญโญโญโญ | ๐ฐ ูุฌุงูู | โญโญ | โญโญโญโญโญ |
| Server Proxy | โญโญโญ | ๐ฐ๐ฐ ูุชูุณุท | โญโญโญโญโญ | โญโญโญโญ |
| Chrome Extension | โญโญ | ๐ฐ ูุฌุงูู | โญโญโญโญ | โญโญโญ |
| Google Drive API | โญ | ๐ฐ๐ฐ๐ฐ ูููู | โญโญโญโญโญ | โญโญโญโญโญ |

---

## โ ุงูุชูุตูุฉ ุงูุญุงููุฉ

**ููุงุณุชุฎุฏุงู ุงูููุฑู:**
- ุงุณุชุฎุฏู **ุงูุญู 1** (ุงููุทุจู ุญุงููุงู)
- ุนููู ุงููุณุชุฎุฏููู ุนูู ุฅุนุงุฏุฉ ุงูุชุณููุฉ ูุฏููุงู

**ููุชุทููุฑ ุงููุณุชูุจูู:**
- ุฅุฐุง ูุงู ุงูููุฒุงููุฉ ุชุณูุญ: **ุงูุญู 2** (Server Proxy)
- ุฅุฐุง ููุช ุชุฑูุฏ ุญูุงู ุงุญุชุฑุงููุงู: **ุงูุญู 4** (Google Drive API)

---

## ๐๏ธ ููููุฉ ุชุทุจูู Server Proxy (ุงูุญู 2)

### ุงูุฎุทูุฉ 1: ุฅูุดุงุก API Route

```bash
# ุฅูุดุงุก ุงูููู
touch src/app/api/download-proxy/route.ts
```

### ุงูุฎุทูุฉ 2: ูุชุงุจุฉ ุงูููุฏ

```typescript
// src/app/api/download-proxy/route.ts
import { NextRequest, NextResponse } from 'next/server';

export async function GET(request: NextRequest) {
  try {
    const searchParams = request.nextUrl.searchParams;
    const fileUrl = searchParams.get('url');
    const fileName = searchParams.get('filename');

    if (!fileUrl || !fileName) {
      return NextResponse.json(
        { error: 'Missing url or filename' },
        { status: 400 }
      );
    }

    // ุชุญููู ุงูููู ูู Google Drive
    const response = await fetch(fileUrl);
    
    if (!response.ok) {
      throw new Error('Failed to fetch from Google Drive');
    }

    const blob = await response.blob();
    const arrayBuffer = await blob.arrayBuffer();

    // ุฅุฑุณุงู ุงูููู ุจุงูุงุณู ุงููุฎุตุต
    return new NextResponse(arrayBuffer, {
      headers: {
        'Content-Type': 'image/jpeg',
        'Content-Disposition': `attachment; filename="${fileName}"`,
        'Cache-Control': 'public, max-age=31536000',
      },
    });
  } catch (error) {
    console.error('Download proxy error:', error);
    return NextResponse.json(
      { error: 'Download failed' },
      { status: 500 }
    );
  }
}
```

### ุงูุฎุทูุฉ 3: ุชุนุฏูู ุฏุงูุฉ ุงูุชุญููู

```typescript
// ูู src/app/dashboard/page.tsx
const downloadUrl = `/api/download-proxy?url=${encodeURIComponent(googleDriveUrl)}&filename=${encodeURIComponent(fileName)}`;

const link = document.createElement('a');
link.href = downloadUrl;
link.download = fileName;
link.click();
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ุญุฏูุฏ Vercel:
- **Function Timeout:** 10 ุซูุงูู (Hobby plan)
- **Response Size:** 4.5 MB max
- **Bandwidth:** ูุญุฏูุฏ ุญุณุจ ุงูุฎุทุฉ

### ุฅุฐุง ูุงูุช ุงูุตูุฑ ูุจูุฑุฉ:
- ูุฏ ุชุชุฌุงูุฒ ุญุฏูุฏ Vercel
- ูุฏ ูููู ุงูุชุญููู ุจุทูุฆุงู
- ูุฏ ุชุญุชุงุฌ ุชุฑููุฉ ุงูุฎุทุฉ

---

## ๐ฏ ุงูุฎูุงุตุฉ

**ุงููุถุน ุงูุญุงูู:**
- โ ุงูุชุทุจูู ูุนูู
- โ ููุชุญ ุฑูุงุจุท ุงูุชุญููู
- โ ูุง ูููู ุชุญุฏูุฏ ุงุณู ุงูููู ุชููุงุฆูุงู (ูููุฏ Google Drive)

**ุงูุญู ุงููุทุจู:**
- ุฑุณุงุฆู ุชูุถูุญูุฉ ูููุณุชุฎุฏู
- ูุชุญ tabs ูุชุนุฏุฏุฉ
- ุงูุชุฑุงุญ ุฃุณูุงุก ูุฑูุฏุฉ (ููุชูุซูู)

**ููุชุทููุฑ ุงููุณุชูุจูู:**
- ุชุทุจูู Server-Side Proxy
- ุฃู ุงุณุชุฎุฏุงู Google Drive API
- ุฃู ูุจูู ุงููููุฏ ุงูุญุงููุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 16 ููููุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ูุนูู ูุน ูููุฏ Google Drive  
**ุงูุชูุตูุฉ:** ุงุณุชุฎุฏู ุงูุญู ุงูุญุงูู ุฃู ุทุจูู Server Proxy
