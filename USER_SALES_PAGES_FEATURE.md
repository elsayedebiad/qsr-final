# ميزة تخصيص صفحات المبيعات للمستخدمين

## نظرة عامة
تم إضافة ميزة تسمح للأدمن العام بتخصيص صفحات المبيعات لأي حساب (مبيعات أو مستخدم عادي). عند مشاركة سيرة ذاتية من الداشبورد، إذا كان للمستخدم صفحات مخصصة، سيظهر popup احترافي يعرض جميع الروابط المخصصة.

## الميزات المضافة

### 1. نموذج قاعدة البيانات
- تم إضافة نموذج `UserSalesPage` في `prisma/schema.prisma`
- يربط المستخدمين بصفحات المبيعات المخصصة لهم
- يدعم تخصيص أكثر من صفحة لكل مستخدم

### 2. API Routes
- `GET /api/user-sales-pages` - جلب جميع التخصيصات أو تخصيصات مستخدم محدد
- `POST /api/user-sales-pages` - إضافة تخصيص جديد (للأدمن فقط)
- `DELETE /api/user-sales-pages/[id]` - حذف تخصيص (للأدمن فقط)

### 3. صفحة الإدارة
- `/dashboard/user-sales-pages` - صفحة إدارة لتخصيص صفحات المبيعات
- متاحة فقط للأدمن العام
- واجهة سهلة لإضافة وحذف التخصيصات
- عرض جميع التخصيصات مع إمكانية البحث

### 4. مكون Popup للمشاركة
- `SalesPagesSharePopup` - مكون احترافي لعرض روابط صفحات المبيعات
- يظهر تلقائياً عند مشاركة سيرة ذاتية إذا كان للمستخدم صفحات مخصصة
- يدعم نسخ الرابط والمشاركة المباشرة
- تصميم احترافي مع ألوان مميزة لكل صفحة

### 5. تعديل دالة المشاركة
- تم تعديل `shareSingleCV` في `dashboard/page.tsx`
- تتحقق تلقائياً من وجود صفحات مخصصة للمستخدم
- إذا وُجدت صفحات مخصصة، تعرض popup بدلاً من المشاركة الافتراضية

## خطوات التثبيت

### 1. تشغيل Migration
```bash
npx prisma migrate dev --name add_user_sales_pages
```

أو إذا كنت تستخدم Prisma Studio:
```bash
npx prisma db push
```

### 2. إعادة بناء Prisma Client
```bash
npx prisma generate
```

### 3. إعادة تشغيل الخادم
```bash
npm run dev
```

## كيفية الاستخدام

### للأدمن العام:
1. انتقل إلى `/dashboard/user-sales-pages`
2. اختر مستخدم من القائمة
3. اختر صفحة مبيعات من القائمة
4. اضغط "إضافة التخصيص"
5. يمكنك إضافة أكثر من صفحة لنفس المستخدم

### للمستخدمين (مبيعات/عادي):
1. عند مشاركة سيرة ذاتية من الداشبورد
2. إذا كان لديك صفحات مخصصة، سيظهر popup تلقائياً
3. اختر الصفحة المطلوبة وانسخ الرابط أو شاركه مباشرة
4. الرابط سيكون بالشكل: `http://localhost:3000/cv/8682?from=sales3`

## الصفحات المدعومة
- sales1 إلى sales11
- gallery (المعرض الرئيسي)
- transfer-services (معرض نقل الخدمات)

## ملاحظات
- فقط الأدمن العام يمكنه إدارة التخصيصات
- يمكن تخصيص أكثر من صفحة لنفس المستخدم
- عند مشاركة سيرة ذاتية، إذا لم يكن هناك صفحات مخصصة، يعمل النظام بالسلوك الافتراضي
- الروابط المخصصة تحتوي على معامل `from` لتتبع المصدر

