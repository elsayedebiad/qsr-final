# ๐ช ุญู ูุดููุฉ Cookie ูุงูุตูุญุงุช ุงููุนุทูุฉ

## โ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ

ุนูุฏูุง ุชุฌุนู ูููุฉ ุตูุญุฉ = 0 ูู ูุธุงู ุงูุชูุฒูุนุ ุงููุณุชุฎุฏููู ุงููุฏุงูู **ูุณุชูุฑูู ูู ุงููุตูู ุฅูููุง** ุจุณุจุจ ุงูู Cookie ุงููุญููุธ!

### **ูุซุงู:**
```
ุงูููู 1: ุงููุณุชุฎุฏู ูุฏุฎู โ ููุฎุชุงุฑ sales10 โ ููุญูุธ ูู cookie
ุงูููู 2: ุชุฌุนู sales10 = 0 ูู ุงูุชูุฒูุน
ุงูููู 3: ููุณ ุงููุณุชุฎุฏู ูุฏุฎู โ Cookie ููุฌูุฏ โ ูุฐูุจ ูู sales10 ุฑุบู ุฃููุง ูุนุทูุฉ! โ
```

---

## โ ุงูุญู ุงููุทุจู ูู ุงูููุฏ

### **1. ูุธุงู Version Control ููููุงุนุฏ:**

```typescript
const rulesVersion = 'v2' // ูุณุฎุฉ ุงูููุงุนุฏ
const versionCookieName = 'td_rules_version'

// ุนูุฏ ุชุบููุฑ ุงูููุงุนุฏุ ูุบูุฑ ุงูุฅุตุฏุงุฑ
if (currentVersion !== rulesVersion) {
  shouldResetCookie = true // ุงูุณุญ ุงูู cookies ุงููุฏููุฉ
  document.cookie = `${versionCookieName}=${rulesVersion}; ...`
}
```

### **2. ุงูุชุญูู ูู ุงูุตูุญุฉ ุงููุญููุธุฉ:**

```typescript
// ุงูุชุญูู ุฃู ุงูุตูุญุฉ ุงููุญููุธุฉ ูุง ุชุฒุงู ูุดุทุฉ
const previousTarget = pickWeighted(table, randomValue).path
const isStillActive = table.some(item => 
  item.path === previousTarget && item.weight > 0
)

if (!isStillActive) {
  // ุงูุตูุญุฉ ูู ุชุนุฏ ูุดุทุฉุ ุงุฎุชุฑ ุตูุญุฉ ุฌุฏูุฏุฉ
  console.log('โ๏ธ Previous page no longer active, selecting new page...')
  randomValue = Math.random()
  // ุญูุธ cookie ุฌุฏูุฏ
  document.cookie = `${cookieName}=${randomValue}; ...`
}
```

---

## ๐ง ููููุฉ ุงูุชุทุจูู

### **ุงูุฎูุงุฑ 1: ุชูุนูู ุงูุญู ุงูุชููุงุฆู** โ

ุงูููุฏ ุงูุฌุฏูุฏ ูุนูู ุชููุงุฆูุงู! ูู ูุง ุนููู:

1. **ุบูุฑ ูุณุฎุฉ ุงูููุงุนุฏ** ูู `/sales/page.tsx`:
```typescript
const rulesVersion = 'v3' // ุบูุฑูุง ูููุง ุนุฏูุช ุงูููุงุนุฏ
```

2. **ุงุญูุธ ุงูููู** ูุงูุดุฑ ุงูุชุญุฏูุซ

3. **ุงููุชูุฌุฉ:**
   - ุงููุณุชุฎุฏููู ุงููุฏุงูู โ cookies ุชููุณุญ โ ุตูุญุฉ ุฌุฏูุฏุฉ
   - ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ โ ูุญุตููู ุนูู ุงูุตูุญุฉ ุงูุตุญูุญุฉ ูุจุงุดุฑุฉ

---

### **ุงูุฎูุงุฑ 2: ุชูููู ูุฏุฉ ุงูู Cookie** โฑ๏ธ

ูู ุงูุณุทุฑ 186ุ ุบูุฑ ุงููุฏุฉ:

```typescript
// ุจุฏูุงู ูู 7 ุฃูุงู
document.cookie = `${cookieName}=${randomValue}; Path=/; Max-Age=${7 * 24 * 60 * 60}; ...`

// ุงุฌุนููุง ุณุงุนุฉ ูุงุญุฏุฉ ููุท
document.cookie = `${cookieName}=${randomValue}; Path=/; Max-Age=${60 * 60}; ...`

// ุฃู 30 ุฏูููุฉ
document.cookie = `${cookieName}=${randomValue}; Path=/; Max-Age=${30 * 60}; ...`
```

**ุงููุฒุงูุง:**
- โ ุงูุชูุฒูุน ูุชุญุฏุซ ุจุดูู ุฃุณุฑุน
- โ ุฃูู ูุดุงูู ูุน ุงูุตูุญุงุช ุงููุนุทูุฉ

**ุงูุนููุจ:**
- โ ููุณ ุงููุณุชุฎุฏู ูุฏ ูุฑู ุตูุญุงุช ูุฎุชููุฉ

---

### **ุงูุฎูุงุฑ 3: ุฅูุบุงุก ุงูู Sticky Session ููุงุฆูุงู** ๐ซ

```typescript
// ุงุญุฐู ูู ููุทู ุงูู cookie ูุงุณุชุจุฏูู ุจู:
const randomValue = Math.random()
const target = pickWeighted(table, randomValue).path
```

**ุงููุฒุงูุง:**
- โ ูุง ูุดุงูู ูุน ุงูุตูุญุงุช ุงููุนุทูุฉ
- โ ุชูุฒูุน ูุซุงูู ุฏุงุฆูุงู

**ุงูุนููุจ:**
- โ ููุณ ุงููุณุชุฎุฏู ูุฑู ุตูุญุงุช ูุฎุชููุฉ ูู ูุฑุฉ
- โ ูุฏ ูุคุซุฑ ุนูู ุชุชุจุน ุงูุฅุนูุงูุงุช

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### **ุงุฎุชุจุงุฑ ุงูุญู:**

1. **ูุจู ุงูุชุนุฏูู:**
```bash
# ุงูุชุญ /sales โ ูุฐูุจ ูู sales10
# ุงุฌุนู sales10 = 0 ูู ุงูุชูุฒูุน
# ุงูุชุญ /sales ูุฑุฉ ุฃุฎุฑู โ ูุง ูุฒุงู ูุฐูุจ ูู sales10 โ
```

2. **ุจุนุฏ ุงูุชุนุฏูู:**
```bash
# ุงูุชุญ /sales โ ูุฐูุจ ูู sales10
# ุงุฌุนู sales10 = 0 ูู ุงูุชูุฒูุน
# ุบูุฑ rulesVersion ุฅูู 'v3'
# ุงูุชุญ /sales โ ูุฐูุจ ูุตูุญุฉ ุฃุฎุฑู โ
```

3. **ูุญุต Console:**
```javascript
// ุณุชุฌุฏ ูู console:
โ๏ธ Previous page no longer active, selecting new page...
๐ฏ Distribution Result:
  Selected page: sales2  // ุตูุญุฉ ุฌุฏูุฏุฉ!
```

---

## ๐ ููุงุฑูุฉ ุงูุญููู

| ุงูุญู | ุงูุณุฑุนุฉ | ุงูุฏูุฉ | ุณูููุฉ ุงูุชุทุจูู | ูุชู ุชุณุชุฎุฏูู |
|------|--------|-------|---------------|------------|
| **Version Control** | โญโญโญโญโญ | โญโญโญโญโญ | โญโญโญโญ | ุนูุฏ ุชุบููุฑ ุงูููุงุนุฏ |
| **ุชูููู ุงููุฏุฉ** | โญโญโญโญ | โญโญโญโญ | โญโญโญโญโญ | ููููุงูุน ุงููุดุทุฉ |
| **ุฅูุบุงุก Cookie** | โญโญโญโญโญ | โญโญโญ | โญโญโญโญโญ | ููุงุฎุชุจุงุฑ ููุท |
| **ูุณุญ ูุฏูู** | โญโญ | โญโญโญโญโญ | โญโญ | ููุชุดุฎูุต |

---

## ๐ ุงูุชูุตูุฉ ุงูููุงุฆูุฉ

### **ููุฅูุชุงุฌ:**
```typescript
// 1. ุงุณุชุฎุฏู Version Control
const rulesVersion = 'v2' // ุบูุฑูุง ุนูุฏ ุชุนุฏูู ุงูููุงุนุฏ

// 2. ููู ูุฏุฉ Cookie ุฅูู ููู ูุงุญุฏ
Max-Age=${24 * 60 * 60}

// 3. ุฃุถู log ูููุฑุงูุจุฉ
console.log('๐ Cookie Status:', existingCookie ? 'Exists' : 'New')
```

### **ููุงุฎุชุจุงุฑ:**
```javascript
// ูู Console:
// ูุณุญ ูู cookies ุงููููุน
document.cookie.split(";").forEach(c => {
  document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
});
location.reload();
```

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ุงูุญู:

1. **sales10 ุจูููุฉ 0** โ ูู ูุฏุฎููุง ุฃุญุฏ โ
2. **ุงููุณุชุฎุฏููู ุงููุฏุงูู** โ ููุญูููู ูุตูุญุงุช ุฃุฎุฑู โ
3. **ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ** โ ูุญุตููู ุนูู ุงูุชูุฒูุน ุงูุตุญูุญ โ
4. **ุงูุชูุงุฑูุฑ** โ ุชุนูุณ ุงูุชูุฒูุน ุงููุนูู โ

---

## ๐ ููุงุญุธุงุช ูููุฉ

### **ุชุญุฐูุฑ:**
- ุชุบููุฑ `rulesVersion` ูุคุซุฑ ุนูู **ุฌููุน ุงููุณุชุฎุฏููู**
- ุงุณุชุฎุฏูู ููุท ุนูุฏ ุชุบููุฑุงุช ูุจูุฑุฉ ูู ุงูููุงุนุฏ

### **ูุตูุญุฉ:**
- ุฑุงูุจ Console logs ุจุนุฏ ุงูุชุทุจูู
- ุชุฃูุฏ ูู ุฃู ุงูุตูุญุงุช ุงูุจุฏููุฉ ุฌุงูุฒุฉ
- ุงุฎุชุจุฑ ูู ุจูุฆุฉ ุชุทููุฑ ุฃููุงู

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2024-10-24
**ุงูุฅุตุฏุงุฑ:** 1.0
